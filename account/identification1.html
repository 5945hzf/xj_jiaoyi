<!--账户 编辑.提交审核-->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="format-detection" content="telephone=no" />
    <title adct1="1">新疆化学品经营服务平台</title>
    <link rel="stylesheet" type="text/css" href="../css/index.css"/>
    <style type="text/css">
        .xiaoshi{display: none;}
        .btn{width: 359px;height: 51px;line-height:51px;background-color: #007aff;border-radius: 5px;text-align: center;color: white;margin-left: 87px;margin-top: 54px;}
        .red{color: red;}
        img{float: left;}
         a{color: #80acf8;}
         html,body{min-width: 988px;width: 988px;background-color: white;overflow: hidden;margin: auto;font-size: 14px;}
        .container{width:986px;border: 1px solid #f1f1f1;}
        .header{padding-top:21px;height:62px;box-sizing:border-box;}
        .header>ul{overflow: hidden;}
        .header>ul>li{float: left;height: 18px;line-height: 18px;font-size: 16px;width: 20%;text-align: center;}
        .header>ul>.row{line-height: 10px;margin-left: 4px;}
        .header>ul>li>a{color: #666;}
        .header>ul>li>a.active{color: #80acf8;}
        .header>ul>li>a>div{color: white;height: 18px;line-height: 18px; text-align: center; width: 18px;border-radius: 50%;font-size:11px;margin: 0 4px; }
        .header>ul>li>a>.orange{background-color: #ffae4c;}
        .header>ul>li>a>.lan{background-color: #80aeff;}

        .center1{padding: 52px 0px 66px 155px;border-bottom: 1px solid #f1f1f1;}
        .center1>ul>li{overflow: hidden;margin-top: 17px;}
        .center1>ul>li>.left1{width: 199px;height: 38px;line-height: 38px;text-align: right;margin-right: 20px;}
        .center1>ul>li>.right1{overflow: hidden;}
        .center1>ul>li>.right1>input{width: 359px;height: 32px;font-size: 14px;color: #666666;text-indent: 10px;}
        .center1>ul>li>.right1>.date-input{width: 149px; text-indent: 4px;}
        .center1>ul>li>.right1>.uploade{position: relative;width: 150px;height: 100px;line-height: 100px;text-align: center; border: 1px solid #ebe9ea;}
        .center1>ul>li>.right1>.uploade>i{position: absolute;top: 0;left: 0;right: 0;bottom: 0;}
        .center1>ul>li>.right1>.uploade>img{position: absolute;top: 0;left: 0;right: 0;bottom: 0;width: 100%;height: 100%;}
        .center1>ul>li>.right1>.uploade>input{position: absolute;top: 0;left: 0;right: 0;bottom: 0;opacity: 0;width: 100%;}
        .center1>ul>li>.right2{line-height: 38px;margin-left: -30px;}
        .center1>ul>li>.right2>input{margin-left: 30px;}

        .bottom1{padding: 59px 0px 54px 83px;border-bottom: 1px solid #f1f1f1;overflow: hidden}
        .bottom1>.left1{margin: 91px 131px 0 0;}
        .bottom1>.right2{ margin-left: 70px;}
        .bottom1>.right2>ul{}
        .bottom1>.right2>ul>li{overflow: hidden;margin-top: 17px;display: block;}
        .bottom1>.right2>ul>li>.left1{height: 38px;line-height: 38px;text-align: right;margin-right: 20px;}
        .bottom1>.right2>ul>li>.right1{overflow: hidden;}
        .bottom1>.right2>ul>li>.right1>input{width: 359px;height: 32px;font-size: 14px;color: #666666;text-indent: 10px;}
        .bottom1>.right2>ul>li>.right1>.date-input{width: 169px;}
        .bottom1>.right2>ul>li>.right1>.uploade{position: relative;width: 150px;height: 100px;line-height: 100px;text-align: center;margin-right: 20px; border: 1px solid #ebe9ea;}
        .bottom1>.right2>ul>li>.right1>.uploade>i{position: absolute;top: 0;left: 0;right: 0;bottom: 0;}
        .bottom1>.right2>ul>li>.right1>.uploade>img{position: absolute;top: 0;left: 0;right: 0;bottom: 0;width: 100%;height: 100%;}
        .bottom1>.right2>ul>li>.right1>.uploade>input{position: absolute;top: 0;left: 0;right: 0;bottom: 0;opacity: 0;width: 100%;}
        .bottom1>.right2>ul>li>.right2{line-height: 38px;margin-left: -30px;}
        .bottom1>.right2>ul>li>.right2>input{margin-left: 30px;}

        input#wenjian {
            position: absolute;
            top: 0px;
            left: 0px;
            bottom: 0px;
            right: 0px;
            width: 69%;
            height: 100%;
            opacity: 0;
        }


        i.red {
            margin-right: 3px;    
        }

        /*input[disabled] {
            opacity: 0.5;
        }*/

        .btn:hover {
            cursor: pointer;
        }

        .inputfile {
            position: absolute;
            z-index: 1;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            margin: 0 !important;
        }

        .uploade {
            background: url(../img/product_pic.png);
        }

        .center1>ul>li {
            position: relative;
        }

        span.ts.yingye {
            position: absolute;
            left: 370px;
            top: 37px;
        }

        .next_btn_update {
            display: none;
        }

        .delete_btn {
            color: #80acf8;
            position: absolute;
            left: 380px;
            top: 85px;
            cursor: pointer;
        }

        .delete_btn1 {
            color: #80acf8;
            position: absolute;
            left: 380px;
            top: 124px;
            cursor: pointer;
        }

        .ts_color {
            color: rgb(0, 122, 255);
        }

        .card_pic_ts {
            color: #999;
            font-size: 14px;
            margin-left: 89px;
        }

        .card_pic_ts span {
            display: inline-block;
            width: 152px;
            text-align: center;
        }

        
        .look_bigpic {
            position: absolute;
            left: 345px;
            bottom: 42px;
            color: rgb(0, 122, 255);
            cursor: pointer;
            z-index: 200;
        }

        .look_bigpic1 {
            position: absolute;
            left: 345px;
            bottom: 2px;
            color: rgb(0, 122, 255);
            cursor: pointer;
            z-index: 200;
        }


        .look_bigpic2 {
            position: absolute;
            left: 500px;
            bottom: 250px;
            color: rgb(0, 122, 255);
            cursor: pointer;
            z-index: 200;
        }

        .look_bigpic3 {
            position: absolute;
            left: 673px;
            bottom: 250px;
            color: rgb(0, 122, 255);
            cursor: pointer;
            z-index: 200;
        }

        .look_bigpic img, .look_bigpic1 img, .look_bigpic2 img, .look_bigpic3 img{
            width: 25px;
        }
        
        /*.mask{position: fixed;left: 0;top: 0; right: 0;bottom: 0;background-color: #000;opacity:0.5;filter: Alpha(opacity=50);z-index: 98;transition:all 1s;display: none}

        .bigimg {
            z-index: 200;
            position: fixed;
            top: 0px;
            left: 0px;
            right: 0px;
            bottom: 0px;
            margin: auto;
        }*/
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <ul>
            <li>
                <a class="active" href="./identification1.html">
                    <!-- <div class="Lf orange">1</div> -->
                    企业基本信息
                </a>
            </li>
            <!-- <li class="row">
                ..................
            </li> -->
            <li>
                <a href="./identification2.html">
                    <!-- <div class="Lf lan">2</div> -->
                    运营者信息
                </a>
            </li>
            <!-- <li class="row">
                ..................
            </li> -->
            <li>
                <a href="./identification3.html">
                    <!-- <div class="Lf lan">3</div> -->
                    发票信息
                </a>
            </li>
            <!-- <li class="row">
                ..................
            </li> -->
            <li>
                <a href="./identification4.html">
                    <!-- <div class="Lf lan">4</div> -->
                    出金账户绑定
                </a>
            </li>
            <!-- <li class="row">
                ..................
            </li> -->
            <li>
                <a href="./identification5.html">
                    <!-- <div class="Lf lan">5</div> -->
                    财务信息
                </a>
            </li>
        </ul>
    </div>
    <div><img style="display: block;width: 100%;" src="../img/identification1_hzf.png" alt=""></div>
    <div class="center1">
        <ul>
            <li>
                <div class="left1 Lf"><i class="red">*</i>企业名称:</div>
                <div class="right1 Lf"><input type="text" id="qiye_name" placeholder="请与营业执照一致，最长100字"></div>
                <span class="ts"></span>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>注册资金:</div>
                <div class="right1 Lf"><input type="text" id="zhuce_money" style="width: 320px;"><span style="margin-left: 10px;">万元</span></div>
                <span class="ts"></span>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>营业执照编号:</div>
                <div class="right1 Lf"><input type="text" id="yingye_num"></div>
                <span class="ts"></span>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>营业期限:</div>
                <!-- <div class="right1 Lf" id="yingye_date">
                    <input type="text" class="date-input laydate-icon" placeholder="请选择日期" id="test1">
                    <span style="height: 38px;line-height: 38px;">&nbsp;-&nbsp; </span>
                    <input type="text" class="date-input laydate-icon" placeholder="请选择日期" id="test2">
                </div> -->
                <div class="right1 Lf" id="yingye_date">
                    <input type="text" class="" id="test3">
                </div>
                <span class="ts"></span>
            </li>
            <li class="clearfix" style="overflow: visible;">
                <div class="left1 Lf"><i class="red">*</i>公司地址:</div>
                <div style="margin-left: 4px;">
                    <div class="selectPub provice1" id="province" data-selectedindex="-1" style="float: left;width: 126px;">
                        <span style="display: inline-block;max-width: 70px;overflow: hidden;  white-space: nowrap;text-overflow: ellipsis;">请选择省</span>
                        <img src="../img/prl-select.jpg" alt="">
                        <ul>

                        </ul>
                    </div>
                    <div class="selectPub city1" id="city" data-selectedindex="-1" style="float: left;width: 126px;">
                        <span style="display: inline-block;max-width: 70px;overflow: hidden;  white-space: nowrap;text-overflow: ellipsis;">请选择市</span>
                        <img src="../img/prl-select.jpg" alt="">
                        <ul>

                        </ul>
                    </div>

                    <div class="selectPub town1" id="area" data-selectedindex="-1" style="float: left;width: 126px;">
                        <span style="display: inline-block;max-width: 70px;overflow: hidden;  white-space: nowrap;text-overflow: ellipsis;">请选择区</span>
                        <img src="../img/prl-select.jpg" alt="">
                        <ul>

                        </ul>
                    </div>
                </div>
                <span class="ts"></span>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>详细地址:</div>
                <div class="right1 Lf"><input type="text" id="company_address"></div>
                <span class="ts"></span>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>营业执照:</div>
                <div class="right1 Lf">
                    <div class="uploade" style="">
                        <i style=""></i>
                        <!-- <img src="../img/list_logo.png" alt="" id="yingye_zhizhao_preview"  title="点击更换图片"> -->
                        <input type="file" id="yingye_zhizhao_pic" class="inputfile" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                        <input type="hidden" name="" value="" class="smallimg" id="yingye_zhizhao_hidden">
                    </div>
                    <i class="ts_color" style="display: block;margin-top: 22px;font-size: 14px;">请上传营业执照或者扫描件！ 照片大小 < 2MB 图片格式为jpg、jpeg、png</i>
                </div>
                <span class="ts yingye"></span>
                <div class="look_bigpic" ><img src="../img/big_pic.png" alt=""></div>
            </li>
            <li>
                <div class="left1 Lf">开户许可证扫描件:</div>
                <div class="right1 Lf">
                    <div class="uploade" style="" id="tu">
                        <i style=""></i>
                        <!-- <img src="../img/list_logo.png" alt="" id="saomiaojian_preview" title="点击更换图片"> -->
                        <input type="file" id="saomiaojian_pic" class="inputfile" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                        <input type="hidden" name="" value="" class="smallimg" id="saomiaojian_hidden">
                    </div>
                </div>
                <span></span>
                <div class="look_bigpic1" ><img src="../img/big_pic.png" alt=""></div>
                <span class="delete_btn">删除</span>
            </li>
            <li>
                <div class="left1" style="width: 418px;">《税务登记证副本》或《一般纳税人资格证书》扫描件:</div>
                <div class="right1 Lf" style="margin-left: 218px;">
                    <div class="uploade" style="">
                        <i style=""></i>
                        <!-- <img src="../img/list_logo.png" alt="" id="chajian_preview" title="点击更换图片"> -->
                        <input type="file" id="chajian_pic" class="inputfile" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                        <input type="hidden" name="" value="" class="smallimg" id="chajian_hidden">
                    </div>
                </div>
                <span></span>
                <div class="look_bigpic1"><img src="../img/big_pic.png" alt=""></div>
                <span class="delete_btn1">删除</span>
            </li>
            <!-- <li>
                <div class="left1 Lf"><i class="red">*</i>地址:</div>
                <div class="right1 Lf"><input type="text" id="address"></div>
                <span class="ts"></span>
            </li> -->
            <li>
                <div class="left1 Lf"><i class="red">*</i>公司类型:</div>
                <div class="right2 Lf" id="company_type">
                    <input type="radio" name="type1" value="0">厂家
                    <input type="radio" name="type1" value="1" checked="checked">贸易商
                    <input type="radio" name="type1" value="2">终端
                </div>
            </li>
            <li>
                <div class="left1 Lf"><i class="red">*</i>企业认证协议(盖章pdf文件):</div>
                <div class="right1 Lf weiRenZheng" style="position: relative;">
                    <input type="text" placeholder="盖章资料上传" id="wenjian_name"><span onclick="down_moban()" style="margin-left: 55px;color: #80acf8;">《下载企业认证协议模板》</span>
                    <input type="file" id="wenjian" onchange="upload_file(this);" accept="application/pdf" readonly>
                </div>
                <div class="right1 Lf yiRenZheng"><span id="file_look" style="line-height: 38px; color: rgb(0, 122, 255);cursor: pointer;">在线查看</span></div>
            </li>
        </ul>
    </div>

    <div class="bottom1">
        <div class="left1 Lf">
        </div>
        <div class="right2 Lf">
            <ul>
                <li>
                    <div class="left1 Lf"><i class="red">*</i>法人姓名:</div>
                    <div class="right1 Lf"><input type="text" id="faren_name" placeholder="请与营业执照一致，最长100字"></div>
                    <span class="ts"></span>
                </li>
                <li>
                    <div class="left1 Lf"><i class="red">*</i>身份证号:</div>
                    <div class="right1 Lf"><input type="text" id="id_number" maxlength="18"></div>
                    <span class="ts"></span>
                </li>
                <li>
                    <div class="left1 Lf"><i class="red">*</i>证件上传:</div>
                    <div class="right1 Lf">
                        <div class="uploade Lf">
                            <i style=""></i>
                            <!-- <img src="../img/list_logo.png" alt="" id="zhengjian_preview1" title="点击更换图片"> -->
                            <input type="file" id="zhengjian_pic1" class="inputfile" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                            <input type="hidden" name="" value="" class="smallimg" id="zhengjian_hidden1"> 
                        </div>
                        <div class="uploade Lf">
                            <i style=""></i>
                            <!-- <img src="../img/list_logo.png" alt="" id="zhengjian_preview2" title="点击更换图片"> -->
                            <input type="file" id="zhengjian_pic2" class="inputfile" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                            <input type="hidden" name="" value="" class="smallimg" id="zhengjian_hidden2">
                        </div>
                        <span class="ts"></span>
                        <div class="look_bigpic2"><img src="../img/big_pic.png" alt=""></div>
                        <div class="look_bigpic3"><img src="../img/big_pic.png" alt=""></div>
                    </div>
                </li>
                <li style="margin-top: 10px;">
                    <div class="right">
                       <div class="card_pic_ts">
                            <span>请上传身份证正面照片</span>
                            <span style="margin-left: 16px;">请上传身份证反面照片</span>
                        </div>
                    </div>
                </li>
            </ul>

            <div class="btn weiRenZheng next_btn">下一步</div>
            <div class="btn yiRenZheng update_btn">修改企业信息</div>
            <div class="btn next_btn_update">下一步</div>
            <div style="margin-top: 32px; text-align: center; width: 530px;">
                <div class="" style="">
                    <img src="../img/qq.png" alt="" style="float: none; vertical-align: bottom;">
                    <a href="##">客服QQ</a>
                    <span>(工作日10 : 00 - 19 : 00)</span>
                </div>
                <div style="margin-top: 5px;">认证过程中如有疑问，可致电 <a href="##">4000-012-556</a></div>
            </div>
        </div>
    </div>

    <!-- <img src="" alt="" class="bigimg">
    <div class="mask">
        <img src="../img/close.png" alt="">
    </div> -->
 

</div>


<script src="../js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/common.js" type="text/javascript" charset="utf-8"></script>
<!-- <script src="../js/zoom1.js" type="text/javascript" charset="utf-8"></script> -->

<script src="./laydate/laydate.js"></script> <!-- 改成你的路径 -->

<script>


        $(function () {
            window.parent.$("#Iframe").css('height',1586);

            /*
             smallimg   // 小图
             bigimg  //点击放大的图片
             mask   //黑色遮罩
             */
            // var obj = new zoom('mask', 'bigimg','smallimg');
            // obj.init();

        })

        $('.look_bigpic, .look_bigpic1').click(function(e) {
            e.stopPropagation();
            // console.log($(this).parent().find('.uploade').height());
            window.parent.look_pic($(this).parent().find('.uploade').width(), $(this).parent().find('.uploade').height(), $(this).parent().find('.smallimg').val());
        });

        $('.look_bigpic2').click(function(e) {
            e.stopPropagation();
            // console.log($(this).parent().find('.uploade').height());
            window.parent.look_pic($(this).parent().find('.uploade').eq(0).width(), $(this).parent().find('.uploade').eq(0).height(), $(this).parent().find('.smallimg').eq(0).val());
        });

        $('.look_bigpic3').click(function(e) {
            e.stopPropagation();
            // console.log($(this).parent().find('.uploade').height());
            window.parent.look_pic($(this).parent().find('.uploade').eq(1).width(), $(this).parent().find('.uploade').eq(1).height(), $(this).parent().find('.smallimg').eq(1).val());
        });


        $(document).on('change','#yingye_zhizhao_pic,#saomiaojian_pic,#chajian_pic,#zhengjian_pic1,#zhengjian_pic2',function(){
            xmTanUploadImg11(this);
        })

        
        $('.delete_btn1, .delete_btn').click(function() {
            $(this).parent().find('.uploade').css('background', 'url("") rgb(246, 246, 246)');
            $(this).parent().find('.uploade').find('input[type="hidden"]').val('');
        });

        
        selectProvince('');

        /*查询所有省份*/
        function selectProvince(province_select) {
            $.ajax({
                url: pubIP + 'address/listProvince', /*v1.0*/
                type: 'post',
                headers: {
                    Accept: "application/json; charset=utf-8",
                    token: token
                },
                cache: false,
                ansyc: false,
                dataType: 'json',
                success: function (data) {
                   console.log(data);
                    var str = '';
                    for (var i = 0; i < data.data.length; i++) {
                        str += '<li  data-index="'+i+'" value="'+i+'" data-proviceId="'+data.data[i].provinceid+'" data-province="'+data.data[i].province+'">'+data.data[i].province+'</li>';
                    }

                    $('#province ul').html(str);

                    $('#province span').text($('#province ul li[data-proviceId="'+province_select+'"]').attr('data-province'));

                    $('#province ul li').click(function(){
                        event.stopPropagation();
                        $(this).parent().parent().attr('data-selectedindex', $(this).attr('data-index'));
                        $(this).parent().parent().attr('data-proviceid', $(this).attr('data-proviceid'));
                        $(this).parent().parent().find('span').text($(this).text());
                        $(this).parent().parent().children('img').attr('src', '../img/prl-select.jpg')
                        $(this).parent().css('display','none');
                        var provinceID =$("#province").attr('data-proviceid');
                        $('#city span').text('请选择市');
                        $('#area span').html('请选择区');
                        $('#area ul').html("");
                        $('#city').removeClass('id_id1');

                        selectCity(provinceID,null);

                    });
                },
                error: function(err){
                    console.log(err);
                }
            });
        }

        /*查询所有城市*/ 
        function selectCity(provinceID, cityID) {
            $.ajax({
                url: pubIP + 'address/listCityByProvinceId', /*v1.0*/
                type: 'post',
                headers: {
                    Accept: "application/json; charset=utf-8",
                    token: token
                },
                cache: false,
                ansyc: true,
                data: {provinceID: provinceID},
                dataType: 'json',
                success: function (data) {
                     console.log(data.data);
                    var str = '';
                    for (var i = 0; i < data.data.length; i++) {
                        str += '<li data-index="'+i+'"  value="'+i+'" data-cityId="'+data.data[i].cityid+'" data-city="'+data.data[i].city+'">'+data.data[i].city+'</li>';
                    }

                    $('#city ul').html(str);

                    $('#city ul li').click(function(){
                        event.stopPropagation();
                        $(this).parent().parent().attr('data-selectedindex', $(this).attr('data-index'));
                        $(this).parent().parent().attr('data-cityid', $(this).attr('data-cityid'));
                        $(this).parent().parent().find('span').text($(this).text());
                        $(this).parent().parent().children('img').attr('src', '../img/prl-select.jpg')
                        $(this).parent().css('display','none');
                        var cityID =$("#city").attr('data-cityid');
                        $('#area span').text('请选择区');


                        $('#city').removeClass('id_id1');

                        selectArea(cityID, ''); 

                    });

                    // if ($('#city').hasClass('id_id1')) {
                        
                        $('#city span').text($('#city ul li[data-cityId="'+cityID+'"]').attr('data-city'));

                        $('#city').attr('data-cityId', cityID);
                    // }

                    

                    // 编辑回显城市
                    // if ($('#city').hasClass('id_id1')) {
                    //     var data_province = $this.parent().parent().find('td')[2];
                    //     $('#city ul li').each(function (index, element) {
                    //         if ($(this).attr('data-city') == $(data_province).attr('data-city')) {
                    //             //$(this)[0].selected = true;
                    //             $(this).parent().parent().attr("data-cityid",$(this).attr("data-cityid"));
                    //             $(this).parent().parent().attr("data-selectedindex",$(this).attr("data-index"));
                    //             $(this).parent().parent().find("span").text($(this).text());
                    //         }
                    //     });

                    //     var cityID = $("#city").attr('data-cityid');
                    //     $('#area').addClass('id_id2');
                    //     selectArea(cityID, $this);



                    // }

                $();

                $('#city').parent().next().html('');
                        
                },
                error: function(err){
                    console.log(err);
                }
            });
        }

        function selectArea(cityID, areaID) {

            $.ajax({
                url: pubIP + 'address/listAreaByCityID', /*v1.0*/
                type: 'post',
                headers: {
                    Accept: "application/json; charset=utf-8",
                    token: token
                },
                cache: false,
                data: {cityID: cityID},
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    var str = '';
                    for (var i = 0; i < data.data.length; i++) {
                        str += '<li data-index="'+i+'" value="'+i+'" data-areaId="'+data.data[i].areaid+'" data-area="'+data.data[i].area+'">'+data.data[i].area+'</li>';
                    }

                    $('#area ul').html(str);

                    $('#area ul li').click(function(){
                        event.stopPropagation();
                        $(this).parent().parent().attr('data-selectedindex', $(this).attr('data-index'));
                        $(this).parent().parent().attr('data-areaid', $(this).attr('data-areaid'));
                        $(this).parent().parent().find('span').text($(this).text());
                        $(this).parent().parent().children('img').attr('src', '../img/prl-select.jpg')
                        $(this).parent().css('display','none');
                        var areaID =$("#area").attr('data-areaid');


                    });

                    // if ($('#area').hasClass('id_id2')) {

                        console.log($('#area ul li[data-areaId="'+areaID+'"]'));
                       
                        $('#area span').text($('#area ul li[data-areaId="'+areaID+'"]').attr('data-area'));

                        $('#area').attr('data-areaId', areaID);

                    // }

//
                    // if ($('#area').hasClass('id_id2')) {
                    //     var data_province = $this.parent().parent().find('td')[2];
                    //     $('#area ul li').each(function (index, element) {
                    //         if ($(this).attr('data-area') == $(data_province).attr('data-area')) {
                    //           //  $(this)[0].selected = true;
                    //             $(this).parent().parent().attr("data-areaid",$(this).attr("data-areaid"));
                    //             $(this).parent().parent().attr("data-selectedindex",$(this).attr("data-index"));
                    //             $(this).parent().parent().find("span").text($(this).text())
                    //         }
                    //     });
                    // }
//
//                    $('#area').parent().next().html('');

                },
                error: function(err){
                    console.log(err);
                }
            });
        }

        $('#province').on('blur', function () {
            if ($('#province option:selected').text() == '请选择省') {
                $('#province').parent().next().html('请选择省');
            } else {
                $('#province').parent().next().html('');
            }
        });

        $('#city').on('blur', function () {
            if ($('#province option:selected').text() != '请选择省' && $('#city option:selected').text() == '请选择市') {
                $('#city').parent().next().html('请选择市');
            } else {
                $('#city').parent().next().html('');
            }
        });

        $('#area').on('blur', function () {
            if ($('#province option:selected').text() != '请选择省' && $('#city option:selected').text() != '请选择市' && $('#town option:selected').text() == '请选择区') {
                $('#town').parent().next().html('请选择区');
            } else {
                $('#town').parent().next().html('');
            }
        });
        
        function xmTanUploadImg11(obj) {
            var file = obj.files[0];
            if (file.size >= 2097152) {
                alert('上传的图片超过了2MB');
                return;
            }
    
            var formdata=new FormData();
    
            formdata.append('file', file);
            
            $.ajax({
                url: uplodImgPath,
                type: 'post',
                processData: false,  // 告诉jQuery不要去处理发送的数据
                contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
                data: formdata,
                cache: false,
                dataType: 'json',
                success: function (data) {
                    //console.log(data);
                    $(obj).parent().css({
                            'background':'url('+data.url+') no-repeat',
                            'background-position':'center',
                            'background-size':'contain',
                            'background-color':'#f6f6f6'
                    });
                    $(obj).parent().find('input[type="hidden"]').val(data.url);
                    $(obj).parent().parent().next().css('display', 'none');
                },
                error: function (err) {
                    console.log(err);
                }
            });
    
        }

    //下载协议模板
    function down_moban(){
        $.ajax({
            url: pubIP + 'agreement/findAgreementInfo?agreementId=2',
            type: 'get',
            dataType: 'json',
            success: function (data) {
                //console.log(data);
                var thisUrl = data.data.fileUrl;
                openWin("../generic/web/viewer.html?thisUrl="+thisUrl);
            },
            error: function (err) {
                console.log(err);
            }
        })
    }
    function openWin(url) {
        $('body').append($('<a href="' + url + '" target="_blank" id="openWin"></a>'))
        document.getElementById("openWin").click();//点击事件
        $('#openWin').remove();
    }

    var img_url1 = null;
    var img_url2 = null;
    var img_url3 = null;
    var img_url4 = null;
    var img_url5 = null;

    var file_url = null;

    //不同浏览器下的路径不同
    function getObjectURL(file) {
        var url = null;
        if (window.createObjectURL != undefined) { // basic

            url = window.createObjectURL(file);

        } else if (window.URL != undefined) { // mozilla(firefox)

            url = window.URL.createObjectURL(file);

        } else if (window.webkitURL != undefined) { // webkit or chrome

            url = window.webkitURL.createObjectURL(file);
        }

        return url;
    }

    
    function upload_file(obj) {

        var file = obj.files[0].name;
        
        $('#wenjian_name').val(file);

        var formdata = new FormData();
        formdata.append('file', obj.files[0]);

        $.ajax({
            url: uplodImgPath,
            type: 'post',
            processData: false,  // 告诉jQuery不要去处理发送的数据
            contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
            data: formdata,
            cache: false,
            dataType: 'json',
            success: function (data) {
                // console.log(data);
                file_url = data.url;
            },
            error: function (err) {
                console.log(err);
            }
        });
    }


    var startTime = '';
    var endTime = '';
    laydate({
        elem: '#test1',
        format: 'YYYY-MM-DD',
        istime: false,
        choose: function(dates){ //选择好日期的回调
            startTime = dates;
        }   
    });
    laydate({
        elem: '#test2',
        format: 'YYYY-MM-DD',
        istime: false,
        choose: function(dates){ //选择好日期的回调
            endTime = dates;
        } 
    });
    laydate.skin('yahui');  //加载皮肤，参数lib为皮肤名

    $(function () {

        /*修改*/
        console.log(companyId);
        if (companyId) {

            
            //v1.0
            $.ajax({
                url: pubIP + 'companyCertification/getCompanyWriteStateByUserToken',
                type: 'post',
                headers: {
                    Accept: "application/json; charset=utf-8",
                    token: token
                },
                data: {
                    token: token
                },
                cache: false,
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    if (data.data.type == 7) {  //等待审核
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'none');
                      
                        $('.next_btn_update').css('display', 'none');

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                        $(window.parent.document).find('.modelBox6 .info p span').html('企业认证正在等待审核');
                        window.parent.tan6();

                    } else if (data.data.type == 2) {  //正在审核

                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'none');
                        $('.next_btn_update').css('display', 'none');

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                        $(window.parent.document).find('.modelBox6 .info p span').html('企业认证正在审核中');
                        window.parent.tan6();

                    } else if (data.data.type == 3) {  //已认证
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'block');
                        $('.next_btn_update').css('display', 'none');

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                    } else if (data.data.type == 4) {  //已拒绝
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'block');
                        $('.next_btn_update').css('display', 'none');

                        data.data.reasons = JSON.parse(data.data.reasons);
                        // data.data.reasons.msg = $.parseJSON(data.data.reasons.msg);
                        console.log(data.data.reasons);

                        if (data.data.reasons.auditNum == '1') { //添加企业认证
                            //企业认证的审核<span>未通过</span>，请重新修改提交
                            $(window.parent.document).find('.jujue p').html('企业认证的审核<span>未通过</span>，请重新修改提交');
                        } else if (data.data.reasons.auditNum == '2') {
                            $(window.parent.document).find('.jujue p').html('企业基本信息的审核<span>未通过</span>，请重新修改提交');
                        }

                        if (data.data.reasons.reasons != '') {
                            $(window.parent.document).find('.jujue_liyou span').html(data.data.reasons.reasons);
                        } else {
                            
                            $(window.parent.document).find('.jujue_liyou span').html('无');
                        }
                        

                        window.parent.tan5();

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                    } else if (data.data.type == 5) {  //企业资料二次审核中
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'none');
                        $('.next_btn_update').css('display', 'none');

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);
                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                        window.parent.tan6();


                        /*window.parent.tan6();*/
                    } else if (data.data.type == 6) {  //出金账户资料二次审核中
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'block');
                        $('.next_btn_update').css('display', 'none');

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);



                    } else if (data.data.type == 1) { //没有提交
                        $(".yiRenZheng").addClass('xiaoshi');
                        $(".next_btn").css('display', 'block');
                        if (companyId) {
                             $(".next_btn_update").css('display', 'block');
                             $(".next_btn").css('display', 'none');
                        }
                    } else if (data.data.type == 8) {  //已拒绝
                        $(".weiRenZheng").addClass('xiaoshi');
                        $(".update_btn").css('display', 'block');
                        $('.next_btn_update').css('display', 'none');

                        data.data.reasons = JSON.parse(data.data.reasons);
                        // data.data.reasons.msg = $.parseJSON(data.data.reasons.msg);
                        console.log(data.data.reasons);

                        if (data.data.reasons.auditNum == '1') { //添加企业认证
                            //企业认证的审核<span>未通过</span>，请重新修改提交
                            $(window.parent.document).find('.jujue p').html('企业认证的审核<span>未通过</span>，请重新修改提交');
                        } else if (data.data.reasons.auditNum == '2') {
                            $(window.parent.document).find('.jujue p').html('企业基本信息的审核<span>未通过</span>，请重新修改提交');
                        }

                        if (data.data.reasons.reasons != '') {
                            $(window.parent.document).find('.jujue_liyou span').html(data.data.reasons.reasons);
                        } else {
                            
                            $(window.parent.document).find('.jujue_liyou span').html('无');
                        }
                        

                        window.parent.tan5();

                        $('input[type=file]').attr('disabled',true);
                        $('input[type=text]').attr('disabled',true);
                        $('input[type=radio]').attr('disabled',true);

                        $('#province').attr('disabled', true);
                        $('#city').attr('disabled', true);
                        $('#area').attr('disabled', true);

                    }

                    
                },
                error: function (err) {
                    console.log(err);
                }
            })

        } else {
            // 添加
            $(".yiRenZheng").addClass('xiaoshi');
        }
        
        $(document).on('click', '.weiRenZheng.btn', function () {


            if ($('#qiye_name').val() == '') {
                $('#qiye_name').parent().next().html('企业名称不能为空');
                return;
            }
            
            var zhuce_money_reg = $('#zhuce_money').val();
            var reg = /^\d+(\.\d+)?$/; 
            if (reg.test(zhuce_money_reg) != true) {
                $('#zhuce_money').parent().next().html('注册资金必须为数字');
                return false;
            }
            
            var yingye_num_reg = $('#yingye_num').val();

            var reg = /^[A-Z0-9]+$/;
            if (yingye_num_reg == '') {
                $('#yingye_num').parent().next().html('营业执照编号不能为空');
                return false;
            } else if (reg.test(yingye_num_reg) != true) {
                $('#yingye_num').parent().next().html('只能有数字和大写字母');
                return false;
            } else {
                $('#yingye_num').parent().next().html('');
            }
            if($("#province>span").text() == "请选择省"){
                $("#province").parent().next().html("请选择正确的省份");
                return false;
            }
            if($("#city>span").text() == "请选择市"){
                $("#province").parent().next().html("请选择正确的市");
                return false;
            }
            if($("#area>span").text() == "请选择区"){
                $("#province").parent().next().html("请选择正确的区");
                return false;
            }

            // startTime = $('#test1').val();
            // endTime = $('#test2').val();

            // if (startTime == '' || endTime == '' ) {
            //     $('#test2').parent().next().html('营业期限不能为空');
            //     return;
            // } if (startTime > endTime) {
            //     $('#test2').parent().next().html('开始时间不能大于结束时间');
            //     return;
            // } else {
            //     $('#test2').parent().next().html('');
            // }

            if ($('#test3').val() == '') {
                $('#test3').parent().next().html('营业期限不能为空');
                return;
            }

            
            if ($('#company_address').val() == '') {
                $('#company_address').parent().next().html('公司地址不能为空');
                return;
            }

            if ($('#yingye_zhizhao_hidden').val() == '') {
                $('#yingye_zhizhao_hidden').parent().parent().next().html('营业执照不能为空');
                return;
            }

            // if ($('#address').val() == '') {
            //     $('#address').parent().next().html('公司不能为空');
            //     return;
            // }

            if ($('#faren_name').val() == '') {
                $('#faren_name').parent().next().html('法人姓名不能为空');
                return;
            }

            var id_number_reg = $('#id_number').val();
            
            // 身份证号码为15位或者18位，15位时全为数字，18位前17位为数字，最后一位是校验位，可能为数字或字符X 
            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/; 
            // var reg = /^\d+$/
            if(reg.test(id_number_reg) === false) { 
                $('#id_number').parent().next().html('身份证号输入格式不正确');
                return false; 
            } 

            

            if ($('#zhengjian_hidden1').val() == '' && $('#zhengjian_hidden2').val('') == '') {
                $('#zhengjian_hidden2').parent().next().html('证件不能为空');
                return;
            }



            var qiye_name = $('#qiye_name').val();
            var zhuce_money = $('#zhuce_money').val();
            var yingye_num = $('#yingye_num').val();
            var company_address = $('#company_address').val();
            // var address = $('#address').val();



            var provinceId  = $('#province').attr('data-proviceId');
            var cityId  = $('#city').attr('data-cityId');
            var areaId  = $('#area').attr('data-areaId');
            var faren_name = $('#faren_name').val();
            var id_number = $('#id_number').val();

            var radioIndex = $("input[name='type1']:checked").index();

            img_url1 = $('#yingye_zhizhao_hidden').val();
            img_url2 = $('#saomiaojian_hidden').val();
            img_url3 = $('#chajian_hidden').val();
            img_url4 = $('#zhengjian_hidden1').val();
            img_url5 = $('#zhengjian_hidden2').val();

        

            file_name = $('#wenjian_name').val();

            var companyAddress2 = $('#province span').text() + $('#city span').text() + $('#area span').text() + $('#company_address').val();

            
           if ($('#yingye_zhizhao_hidden').val() != '' ) {
                
                if ($('#zhengjian_hidden2').val() != '' && $('#zhengjian_hidden1').val() != '') {

                    var that=this;
                    if($(that).attr("cf_norepeat")=="1"){
                        $(that).attr("cf_norepeat","2")
                    }else if($(that).attr("cf_norepeat")=="2"){
                        return;
                    }else{
                        $(that).attr("cf_norepeat","2")
                    }
                    //v1.0
                    $.ajax({
                        url: pubIP + 'companyCertification/addCompanyBaseInfo',
                        type: 'post',
                        headers: {
                            Accept: "application/json; charset=utf-8",
                            token: token
                        },
                        data: {
                            submit_type: 'A',
                            companyName: qiye_name,
                            registeredCapital: zhuce_money,
                            businessLicense: yingye_num,
                            operatingPeriodStartTime: startTime,
                            // operatingPeriodEndTime: endTime,
                            // companyAddress: company_address,
                            operatingPeriod: $('#test3').val(),
                            companyAddress2: companyAddress2,
                            provinceId: provinceId,
                            cityId: cityId,
                            areaId: areaId,
                            companyType: radioIndex,
                            legalPerson: faren_name,
                            legalIdNumber: id_number,
                            upload_file1: img_url1,
                            upload_file2: img_url2,
                            upload_file3: img_url3,
                            upload_file4: img_url4,
                            upload_file5: img_url5,
                            fileUrl: file_url,
                            fileName: file_name,
                            sourceType: 1
                        },
                        cache: false,
                        dataType: 'json',
                        success: function (data) {
                            $(that).attr("cf_norepeat","1")
                            if (data.code == 1) {
                                console.log(data);
                                console.log(data.data.ids);
                                
                                window.location.href = 'identification2.html';
                            
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (err) {
                            $(that).attr("cf_norepeat","1")
                            console.log(err);
                        }
                    });   
                } else {
                    $('#zhengjian_pic2').parent().next().html('图片正在上传');
                }

            } else {
                $('#yingye_zhizhao_pic').parent().parent().next().html('图片正在上传');
            }
            
        });

        $('#qiye_name').on('blur', function () {
            if ($(this).val() == '') {
                $(this).parent().next().html('企业名称不能为空');
                return false;
            } else {
                $(this).parent().next().html('');
            }
        });

        $('#zhuce_money').on('blur', function () {
            var zhuce_money_reg = $('#zhuce_money').val();
            var reg = /^\d+(\.\d+)?$/; 
            if (reg.test(zhuce_money_reg) != true) {
                $('#zhuce_money').parent().next().html('注册资金必须为数字');
                return false;
            } else {
                $('#zhuce_money').parent().next().html('');
            }
        });

        $('#yingye_num').on('blur', function () {

            var yingye_num_reg = $('#yingye_num').val();

            var reg = /^[A-Z0-9]+$/;
            if (yingye_num_reg == '') {
                $('#yingye_num').parent().next().html('营业执照编号不能为空');
                return false;
            } else if (reg.test(yingye_num_reg) != true) {
                $('#yingye_num').parent().next().html('只能有数字和大写字母');
                return false;
            } else {
                $('#yingye_num').parent().next().html('');
            }
            

        });

        $('#company_address').on('blur', function () {
            if ($(this).val() == '') {
                $(this).parent().next().html('公司地址不能为空');
                return false;
            } else {
                $(this).parent().next().html('');
            }
        });

        // $('#address').on('blur', function () {
        //     if ($(this).val() == '') {
        //         $(this).parent().next().html('公司不能为空');
        //         return false;
        //     } else {
        //         $(this).parent().next().html('');
        //     }
        // });

        $('#faren_name').on('blur', function () {
            if ($(this).val() == '') {
                $(this).parent().next().html('法人姓名不能为空');
                return false;
            } else {
                $(this).parent().next().html('');
            }
        });

        $('#id_number').on('blur', function () {
            var id_number_reg = $('#id_number').val();
            
            // 身份证号码为15位或者18位，15位时全为数字，18位前17位为数字，最后一位是校验位，可能为数字或字符X 
            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/; 
            // var reg = /^\d+$/
            if(reg.test(id_number_reg) === false) { 
                $('#id_number').parent().next().html('身份证号输入格式不正确');
                return false; 
            } else {
                $('#id_number').parent().next().html('');
            }

        });

        $('#yingye_zhizhao_pic').on('blur', function () {
            if ($('#yingye_zhizhao_hidden').val() == '') {
                $('#yingye_zhizhao_hidden').parent().parent().next().html('营业执照不能为空');
            } else {
                $('#yingye_zhizhao_hidden').parent().parent().next().html('');
            }
        });

        $('#zhengjian_pic1').on('blur', function () {
            if ($('#zhengjian_hidden1').val() == '' && $('#zhengjian_hidden2').val() == '') {
                $('#zhengjian_hidden2').parent().next().html('证件不能为空');
            } else {
                $('#zhengjian_hidden2').parent().next().html('');
            }
        });

        $('#zhengjian_pic2').on('blur', function () {
            if ($('#zhengjian_hidden1').val() == '' && $('#zhengjian_hidden2').val() == '') {
                $('#zhengjian_hidden2').parent().next().html('证件不能为空');
            } else {
                $('#zhengjian_hidden2').parent().next().html('');
            }
        });

        
        $('#test3').blur(function() {
            // operatingPeriod
            if ($('#test3').val() == '') {
                $('#test3').parent().next().html('证件不能为空');
            } else {
                $('#test3').parent().next().html('');
            }
        });
        



        /*var companyId1 = window.localStorage.getItem('companyId');
        console.log(companyId1);*/


        /*修改企业信息*/
        /*if ($('.btn.weiRenZheng.next_btn').hasClass('xiaoshi')) {*/

        if (companyId) {

            

            //v1.0
            $.ajax({
                url: pubIP + 'companyCertification/getCompanyBaseInfoAndAccountByCompanyId',
                type: 'post',
                headers: {
                    Accept: "application/json; charset=utf-8",
                    token: token
                },
                data: {
                    companyId: companyId,
                    type: 'A'
                },
                cache: false,
                dataType: 'json',
                success: function (data) {
                    if (data.code == 1) {
                        console.log(data);
                        //下载上传过的企业协议
                        if (data.data.files.length != 0) {
                            var thisUrls = data.data.files[0].fileUrl; 
                            $('#file_look').attr('href', data.data.files[0].fileUrl);
                            $('#file_look').attr('download', data.data.files[0].fileName);   

                            $('#wenjian_name').val(data.data.files[0].fileName);
                            $('#wenjian_name').attr('data-wj', data.data.files[0].dbid);
                            $('#wenjian_name').attr('data-url', data.data.files[0].fileUrl);
                        }
                        
                        $("#file_look").on("click",function () {
                            //window.downloadFile("http://zhongshunxinhe.oss-cn-beijing.aliyuncs.com/jy/adv/imgs/201808213/48a3f6672c51d6fc1dee7e0cdee082b3.pdf");
                            // $.ajax({
                            //     type:"post",
                            //     async:false,  //
                            //     mimeType: 'text/plain; charset=x-user-defined',
                            //     url:"http://file.xjv56.com/bfile/fileDown.htm",
                            //     data:{
                            //         fileUrl: thisUrls
                            //     },
                            //     success:function(data){
                            //         window.downloadFile(data);
                            //     }
                            // });
                            if (data.data.files.length != 0) {
                                openWin("../generic/web/viewer.html?thisUrl="+thisUrls);
                            } else {
                                window.parent.cf_alert1(2, '无协议');
                            }
                            
                        });


                        $('#qiye_name').val(data.data.company.companyName);
                        $('#zhuce_money').val(data.data.company.registeredCapital);
                        $('#yingye_num').val(data.data.company.businessLicense);

                        // data.data.company.operatingPeriodStartTime = new Date(data.data.company.operatingPeriodStartTime).Format("yyyy-MM-dd");
                        
                        // data.data.company.operatingPeriodEndTime = new Date(data.data.company.operatingPeriodEndTime).Format("yyyy-MM-dd");


                        // $('#test1').val(data.data.company.operatingPeriodStartTime);
                        // $('#test2').val(data.data.company.operatingPeriodEndTime);
                        $('#test3').val(data.data.company.operatingPeriod);

                        
                        
                        $('#company_address').val(data.data.company.companyAddress2);

                        // $('#province span').text($('#province ul li[data-proviceId='+data.data.company.provinceId+']').attr('data-province'));

                        $('#province').attr('data-proviceId', data.data.company.provinceId);

                        selectProvince(data.data.company.provinceId);

                        $('#city').addClass('id_id1');
                        $('#area').addClass('id_id2');

                        selectCity(data.data.company.provinceId, data.data.company.cityId);

                        selectArea(data.data.company.cityId, data.data.company.areaId);


                       /* var img_weizhi = data.data.files[0].fileUrl.split("/").length-1;*/

                        /*$('#file_look').attr('data-wj', data.data.files[0].fileUrl.split("/")[img_weizhi]);*/

                        

                        // $('#yingye_zhizhao_pic').parent().css({
                        //     'background': 'url('+data.data.picInfos[0].picUrl+') no-repeat',
                        //     'background-position':'center',
                        //     'background-size':'contain',
                        //     'background-color':'#f6f6f6'
                        // });
                        // $('#yingye_zhizhao_pic').attr('data-picId1', data.data.picInfos[0].ids);
                        if (data.data.picInfos.length != 0) {
                            for (var i = 0; i < data.data.picInfos.length; i++) {
                                if (data.data.picInfos[i].picDescription == 'upload_file1') {
                                    $('#yingye_zhizhao_pic').parent().css({
                                        'background': 'url('+data.data.picInfos[i].picUrl+') no-repeat',
                                        'background-position':'center',
                                        'background-size':'contain',
                                        'background-color':'#f6f6f6'
                                    });
                                    $('#yingye_zhizhao_pic').attr('data-picId1', data.data.picInfos[i].ids);
                                    $('#yingye_zhizhao_hidden').val(data.data.picInfos[i].picUrl);
                        
                                }

                                if (data.data.picInfos[i].picDescription == 'upload_file2') {
                                    $('#saomiaojian_pic').parent().css({
                                        'background': 'url('+data.data.picInfos[i].picUrl+') no-repeat',
                                        'background-position':'center',
                                        'background-size':'contain',
                                        'background-color':'#f6f6f6'
                                    });
                                    $('#saomiaojian_pic').attr('data-picId2', data.data.picInfos[i].ids);
                                    $('#saomiaojian_hidden').val(data.data.picInfos[i].picUrl);
                        
                                }

                                if (data.data.picInfos[i].picDescription == 'upload_file3') {
                                    $('#chajian_pic').parent().css({
                                        'background': 'url('+data.data.picInfos[i].picUrl+') no-repeat',
                                        'background-position':'center',
                                        'background-size':'contain',
                                        'background-color':'#f6f6f6'
                                    });
                                    $('#chajian_pic').attr('data-picId3', data.data.picInfos[i].ids);
                                    $('#chajian_hidden').val(data.data.picInfos[i].picUrl);
                        
                                }

                                if (data.data.picInfos[i].picDescription == 'upload_file4') {
                                    $('#zhengjian_pic1').parent().css({
                                        'background': 'url('+data.data.picInfos[i].picUrl+') no-repeat',
                                        'background-position':'center',
                                        'background-size':'contain',
                                        'background-color':'#f6f6f6'
                                    });
                                    $('#zhengjian_pic1').attr('data-picId4', data.data.picInfos[i].ids);
                                    $('#zhengjian_hidden1').val(data.data.picInfos[i].picUrl);
                        
                                }

                                if (data.data.picInfos[i].picDescription == 'upload_file5') {
                                    $('#zhengjian_pic2').parent().css({
                                        'background': 'url('+data.data.picInfos[i].picUrl+') no-repeat',
                                        'background-position':'center',
                                        'background-size':'contain',
                                        'background-color':'#f6f6f6'
                                    });
                                    $('#zhengjian_pic2').attr('data-picId5', data.data.picInfos[i].ids);
                                    $('#zhengjian_hidden2').val(data.data.picInfos[i].picUrl);
                                }

                            }
                        }
                        

                        

                        // $('#saomiaojian_pic').parent().css({
                        //     'background': 'url('+data.data.picInfos[1].picUrl+') no-repeat',
                        //     'background-position':'center',
                        //     'background-size':'contain',
                        //     'background-color':'#f6f6f6'
                        // });
                        // $('#saomiaojian_pic').attr('data-picId2', data.data.picInfos[1].ids);

                        // $('#chajian_pic').parent().css({
                        //     'background': 'url('+data.data.picInfos[2].picUrl+') no-repeat',
                        //     'background-position':'center',
                        //     'background-size':'contain',
                        //     'background-color':'#f6f6f6'
                        // });
                        // $('#chajian_pic').attr('data-picId3', data.data.picInfos[2].ids);

                        // $('#zhengjian_pic1').parent().css({
                        //     'background': 'url('+data.data.picInfos[3].picUrl+') no-repeat',
                        //     'background-position':'center',
                        //     'background-size':'contain',
                        //     'background-color':'#f6f6f6'
                        // });
                        // $('#zhengjian_pic1').attr('data-picId4', data.data.picInfos[3].ids);

                        // $('#zhengjian_pic2').parent().css({
                        //     'background': 'url('+data.data.picInfos[4].picUrl+') no-repeat',
                        //     'background-position':'center',
                        //     'background-size':'contain',
                        //     'background-color':'#f6f6f6'
                        // });
                        // $('#zhengjian_pic2').attr('data-picId5', data.data.picInfos[4].ids);

                        // $('#yingye_zhizhao_hidden').val(data.data.picInfos[0].picUrl);
                        // $('#saomiaojian_hidden').val(data.data.picInfos[1].picUrl);
                        // $('#chajian_hidden').val(data.data.picInfos[2].picUrl);
                        // $('#zhengjian_hidden1').val(data.data.picInfos[3].picUrl);
                        // $('#zhengjian_hidden2').val(data.data.picInfos[4].picUrl);
                        
                        
                        // $('#address').val(data.data.company.companyAddress2);
                        $("input[name=type1][value="+data.data.company.companyType+"]").attr("checked",true);

                        $('#faren_name').val(data.data.company.legalPerson);
                        $('#id_number').val(data.data.company.legalIdNumber);


                        //不能删除
                        $('.delete_btn1').hide();
                        $('.delete_btn').hide();

                    } else {
                        alert(data.msg);
                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
            
        }

        $(document).on('click', '.yiRenZheng1.btn, .next_btn_update', function () {


            
            if ($('#qiye_name').val() == '') {
                $('#qiye_name').parent().next().html('企业名称不能为空');
                return;
            }
            
            var zhuce_money_reg = $('#zhuce_money').val();
            var reg = /^\d+(\.\d+)?$/; 
            if (reg.test(zhuce_money_reg) != true) {
                $('#zhuce_money').parent().next().html('注册资金必须为数字');
                return false;
            }
            
            var yingye_num_reg = $('#yingye_num').val();

            var reg = /^[A-Z0-9]+$/;
            if (yingye_num_reg == '') {
                $('#yingye_num').parent().next().html('营业执照编号不能为空');
                return false;
            } else if (reg.test(yingye_num_reg) != true) {
                $('#yingye_num').parent().next().html('只能有数字和大写字母');
                return false;
            } else {
                $('#yingye_num').parent().next().html('');
            }

            // startTime = $('#test1').val();
            // endTime = $('#test2').val();
            
            // if (startTime == '' || endTime == '' ) {
            //     $('#test2').parent().next().html('营业期限不能为空');
            //     return;
            // } if (startTime > endTime) {
            //     $('#test2').parent().next().html('开始时间不能大于结束时间');
            //     return;
            // } else {
            //     $('#test2').parent().next().html('');
            // }

            if ($('#test3').val() == '') {
                $('#test3').parent().next().html('营业期限不能为空');
                return;
            }

            
            if ($('#company_address').val() == '') {
                $('#company_address').parent().next().html('公司地址不能为空');
                return;
            }

            // if ($('#address').val() == '') {
            //     $('#address').parent().next().html('公司不能为空');
            //     return;
            // }

            if ($('#faren_name').val() == '') {
                $('#faren_name').parent().next().html('法人姓名不能为空');
                return;
            }

            var id_number_reg = $('#id_number').val();
            
            // 身份证号码为15位或者18位，15位时全为数字，18位前17位为数字，最后一位是校验位，可能为数字或字符X 
            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/; 
            // var reg = /^\d+$/
            if(reg.test(id_number_reg) === false) { 
                $('#id_number').parent().next().html('身份证号输入格式不正确');
                return false; 
            } 

            if ($('#yingye_zhizhao_hidden').val() == '') {
                $('#yingye_zhizhao_hidden').parent().parent().next().html('营业执照不能为空');
                return;
            }

            if ($('#zhengjian_hidden1').val() == '' && $('#zhengjian_hidden2').val() == '') {
                $('#zhengjian_hidden2').parent().next().html('证件不能为空');
                return;
            }



            var qiye_name = $('#qiye_name').val();
            var zhuce_money = $('#zhuce_money').val();
            var yingye_num = $('#yingye_num').val();
            var company_address = $('#company_address').val();
            // var address = $('#address').val();
            var provinceId  = $('#province').attr('data-proviceId');
            var cityId  = $('#city').attr('data-cityId');
            var areaId  = $('#area').attr('data-areaId');
            var faren_name = $('#faren_name').val();
            var id_number = $('#id_number').val();

            var radioIndex = $("input[name='type1']:checked").index();

            var picId1 = $('#yingye_zhizhao_pic').attr('data-picid1');
            var picId2 = $('#saomiaojian_pic').attr('data-picid2');
            var picId3 = $('#chajian_pic').attr('data-picid3');
            var picId4 = $('#zhengjian_pic1').attr('data-picid4');
            var picId5 = $('#zhengjian_pic2').attr('data-picid5');

            img_url1 = $('#yingye_zhizhao_hidden').val();
            img_url2 = $('#saomiaojian_hidden').val();
            img_url3 = $('#chajian_hidden').val();
            img_url4 = $('#zhengjian_hidden1').val();
            img_url5 = $('#zhengjian_hidden2').val();

            

            if (file_url != null) {
                $('#wenjian_name').attr('data-url', file_url);
            }
           
            if ($('.next_btn_update').css('display') == 'block') { //点回的添加
                dbid = $('#wenjian_name').attr('data-wj');
                file_url = $('#wenjian_name').attr('data-url');
                file_name = $('#wenjian_name').val();
            } else {
                dbid = $('#file_look').attr('data-filename');
                file_name = $('#file_look').attr('data-wj');
            }

            console.log(file_url);

            
            if ($('.next_btn_update').css('display') == 'block') {
                if ($('#yingye_zhizhao_hidden').val() != '' && $('#zhengjian_hidden2').val() != '' && $('#zhengjian_hidden1').val() != '' && file_url != null) {
                    $.ajax({
                        url: pubIP + 'companyCertification/addCompanyBaseInfo',
                        type: 'post',
                        headers: {
                            Accept: "application/json; charset=utf-8",
                            token: token
                        },
                        data: {
                            submit_type: 'A',
                            companyId: companyId,
                            companyName: qiye_name,
                            registeredCapital: zhuce_money,
                            businessLicense: yingye_num,
                            // operatingPeriodStartTime: startTime,
                            // operatingPeriodEndTime: endTime,
                            operatingPeriod: $('#test3').val(),
                            companyAddress2: company_address,
                            provinceId: provinceId,
                            cityId: cityId,
                            areaId: areaId,
                            companyType: radioIndex,
                            legalPerson: faren_name,
                            legalIdNumber: id_number,
                            picId1: picId1,
                            picId2: picId2,
                            picId3: picId3,
                            picId4: picId4,
                            picId5: picId5,
                            upload_file1: img_url1,
                            upload_file2: img_url2,
                            upload_file3: img_url3,
                            upload_file4: img_url4,
                            upload_file5: img_url5,
                            fileName: file_name,
                            dbid: dbid,
                            fileUrl: file_url
                        },
                        cache: false,
                        dataType: 'json',
                        success: function (data) {
                            if (data.code == 1) {
                                console.log(data);
                                console.log(data.data.ids);
                                
                                if ($('.next_btn_update').css('display') == 'block') {
                                    window.location.href = "identification2.html";
                                } else {
                                    window.parent.update_qiye();
                                }
                            
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (err) {
                            console.log(err);
                        }
                    });

                }
                
            } else {
                if ($('#yingye_zhizhao_hidden').val() != '' && $('#zhengjian_hidden2').val() != '' && $('#zhengjian_hidden1').val() != '') {
                    $.ajax({
                        url: pubIP + 'companyCertification/addCompanyBaseInfo',
                        type: 'post',
                        headers: {
                            Accept: "application/json; charset=utf-8",
                            token: token
                        },
                        data: {
                            submit_type: 'A',
                            companyId: companyId,
                            companyName: qiye_name,
                            registeredCapital: zhuce_money,
                            businessLicense: yingye_num,
                            // operatingPeriodStartTime: startTime,
                            // operatingPeriodEndTime: endTime,
                            operatingPeriod: $('#test3').val(),
                            companyAddress2: company_address,
                            provinceId: provinceId,
                            cityId: cityId,
                            areaId: areaId,
                            companyType: radioIndex,
                            legalPerson: faren_name,
                            legalIdNumber: id_number,
                            picId1: picId1,
                            picId2: picId2,
                            picId3: picId3,
                            picId4: picId4,
                            picId5: picId5,
                            upload_file1: img_url1,
                            upload_file2: img_url2,
                            upload_file3: img_url3,
                            upload_file4: img_url4,
                            upload_file5: img_url5,
                            fileName: file_name,
                            dbid: dbid,
                            fileUrl: file_url
                        },
                        cache: false,
                        dataType: 'json',
                        success: function (data) {
                            if (data.code == 1) {
                                console.log(data);
                                console.log(data.data.ids);
                                
                                if ($('.next_btn_update').css('display') == 'block') {
                                    window.location.href = "identification2.html";
                                } else {
                                    window.parent.update_qiye();
                                }
                            
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (err) {
                            console.log(err);
                        }
                    });

                }
            }
            

        });
    });

    // function huidian() {
    //     $.ajax({
    //         url: pubIP + 'companyCertification/getCompanyWriteStateByUserToken',
    //         type: 'post',
    //         headers: {
    //             Accept: "application/json; charset=utf-8",
    //             token: token
    //         },
    //         data: {
    //             token: token
    //         },
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             console.log(data);
    //             if (data.data.type != 1) {
    //                 window.parent.update_qiye();
    //             }
    //         },
    //         error: function(error) {
    //             console.log(error);
    //         }
    //     });
    // }

    $(window.parent.document).on('click', '.ook', function () {
        window.location.reload();
    });

	//修改企业信息(放开可修改)
	$(document).on('click','.update_btn',function(){
		$('input[type=file]').attr('disabled',false);
		$('input[type=text]').attr('disabled',false);
		$('input[type=radio]').attr('disabled',false);
        $('#province').attr('disabled', false);
        $('#city').attr('disabled', false);
        $('#area').attr('disabled', false);
        $('.delete_btn').show();
        $('.delete_btn1').show();
		$(this).addClass('yiRenZheng1');
		$(this).text('修改完成');
	})









    // //选择图片，马上预览
    // function xmTanUploadImg1(obj) {
    //     var file = obj.files[0];

    //     if (file.size >= 2097152) {
    //         alert('上传的图片超过了2MB');
    //         return;
    //     }

    //     //添加图片路径到img src中进行预览
    //     $("#yingye_zhizhao_preview").attr('src', getObjectURL(file));

    //     var formdata=new FormData();

    //     var c = $('#yingye_zhizhao_preview')[0];
    //     var path = $(c).attr('src');

    //     formdata.append('file', file);
        
    //     formdata.append('path', path);
    

    //     $.ajax({
    //         url: uplodImgPath,
    //         type: 'post',
    //         processData: false,  // 告诉jQuery不要去处理发送的数据
    //         contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
    //         data: formdata,
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             // console.log(data);
    //             img_url1 = data.url;
    //             $('#yingye_zhizhao_preview').attr('src', img_url1);
    //             $('#yingye_zhizhao_hidden').val(img_url1);
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });

    // }

    // function xmTanUploadImg2(obj) {

    //     var file = obj.files[0];

    //     if (file.size >= 2097152) {
    //         alert('上传的图片超过了2MB');
    //         return;
    //     }

    //     //添加图片路径到img src中进行预览
    //     $("#saomiaojian_preview").attr('src', getObjectURL(file));

    //     var formdata=new FormData();

    //     var c = $('#saomiaojian_preview')[0];
    //     var path = $(c).attr('src');

    //     formdata.append('file', file);
        
    //     formdata.append('path', path);
    

    //     $.ajax({
    //         url: uplodImgPath,
    //         type: 'post',
    //         processData: false,  // 告诉jQuery不要去处理发送的数据
    //         contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
    //         data: formdata,
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             // console.log(data);
    //             img_url2 = data.url;
    //             $('#saomiaojian_preview').attr('src', img_url2);
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }


    // function xmTanUploadImg3(obj) {
    //     var file = obj.files[0];

    //    /* if (file.size >= 2097152) {
    //         alert('上传的图片超过了2MB');
    //         return;
    //     }*/

    //     //添加图片路径到img src中进行预览
    //     $("#chajian_preview").attr('src', getObjectURL(file));

    //     var formdata=new FormData();

    //     var c = $('#chajian_preview')[0];
    //     var path = $(c).attr('src');

    //     formdata.append('file', file);
        
    //     formdata.append('path', path);
    

    //     $.ajax({
    //         url: uplodImgPath,
    //         type: 'post',
    //         processData: false,  // 告诉jQuery不要去处理发送的数据
    //         contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
    //         data: formdata,
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             // console.log(data);
    //             img_url3 = data.url;
    //             $('#chajian_preview').attr('src', img_url3);
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }

    // function xmTanUploadImg4(obj) {
    //     var file = obj.files[0];

    //     /*if (file.size >= 2097152) {
    //         alert('上传的图片超过了2MB');
    //         return;
    //     }*/

    //     //添加图片路径到img src中进行预览
    //     $("#zhengjian_preview1").attr('src', getObjectURL(file));

    //     var formdata=new FormData();

    //     var c = $('#zhengjian_preview1')[0];
    //     var path = $(c).attr('src');

    //     formdata.append('file', file);
        
    //     formdata.append('path', path);
    

    //     $.ajax({
    //         url: uplodImgPath,
    //         type: 'post',
    //         processData: false,  // 告诉jQuery不要去处理发送的数据
    //         contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
    //         data: formdata,
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             console.log(data);
    //             img_url4 = data.url;
    //             $('#zhengjian_preview1').attr('src', img_url4);
    //             $('#zhengjian_hidden1').val(img_url4);
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }

    // function xmTanUploadImg5(obj) {
    //     var file = obj.files[0];

    //     /*if (file.size >= 2097152) {
    //         alert('上传的图片超过了2MB');
    //         return;
    //     }*/

    //     //添加图片路径到img src中进行预览
    //     $("#zhengjian_preview2").attr('src', getObjectURL(file));

    //     var formdata=new FormData();

    //     var c = $('#zhengjian_preview2')[0];
    //     var path = $(c).attr('src');

    //     formdata.append('file', file);
        
    //     formdata.append('path', path);
    

    //     $.ajax({
    //         url: uplodImgPath,
    //         type: 'post',
    //         processData: false,  // 告诉jQuery不要去处理发送的数据
    //         contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
    //         data: formdata,
    //         cache: false,
    //         dataType: 'json',
    //         success: function (data) {
    //             console.log(data);
    //             img_url5 = data.url;
    //             $('#zhengjian_preview2').attr('src', img_url5);
    //             $('#zhengjian_hidden2').val(img_url5);
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }


        function download(url) {
//            var url = 'download/?filename=aaa.txt';
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);    // 也可以使用POST方式，根据接口
            xhr.responseType = "blob";  // 返回类型blob
            // 定义请求完成的处理函数，请求前也可以增加加载框/禁用下载按钮逻辑
            xhr.onload = function () {
                // 请求完成
                if (this.status === 200) {
                    // 返回200
                    var blob = this.response;
                    var reader = new FileReader();
                    reader.readAsDataURL(blob);  // 转换为base64，可以直接放入a表情href
                    reader.onload = function (e) {
                        // 转换完成，创建一个a标签用于下载
                        var a = document.createElement('a');
                        a.download = 'data.xlsx';
                        a.href = e.target.result;
                        $("body").append(a);  // 修复firefox中无法触发click
                        a.click();
                        $(a).remove();
                    }
                }
            };
            // 发送ajax请求
            xhr.send()
        }

</script>
</body>
</html>
