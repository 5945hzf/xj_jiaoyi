<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="format-detection" content="telephone=no" />
	<title adct1="1">新疆化学品经营服务平台</title>
	<link rel="stylesheet" type="text/css" href="../css/index.css"/>
	<link rel="stylesheet" type="text/css" href="../css/home.css"/>
	<link rel="stylesheet" type="text/css" href="../css/common.css"/>
	<link rel="stylesheet" type="text/css" href="../css/standingBook/accountCheckOrderStatus.css">
	<style>
		.qwer{
			display: none;
		}
	</style>
</head>
<body>

	<!-- 兑账订单状态 -->
	<div class="accountCheckOrderStatus">
		<div class="accountCheckOrderStatusTitle">
			<span>订单状态</span>
			<div class="fr kefu">
				<img src="../img/qq.png">
				<span>在线客服</span>
			</div>
		</div>
		<!-- 待我方确定 -->
		<div class="order_status wfqr qwer">
			<img src="../img/account_check_order_status.png">
			<span>待商家确定</span>
		</div>
		<div class="shengyu_time wfqr qwer">
			<p>剩余时间：<span class="time_time">29天8时45分25秒</span>，您可以：</p>
			<div class="operate_btn">
				<span class="span_btn">
					<span class="ok_order">确定</span>
					<span class="jujue_order">拒绝</span>
				</span>
			</div>
		</div>

		<!-- 待对方确认 -->
		<div class="order_status dfqr qwer">
			<img src="../img/account_check_order_status.png">
			<span>待商家确定</span>
		</div>
		<div class="shengyu_time dfqr qwer">
			<p>剩余时间：<span class="time_time">29天8时45分25秒</span>，您可以：</p>
			<div class="operate_btn">
				<span class="cancel_accountCheck_btn">取消兑账</span>
			</div>
		</div>

		<!-- 等待对方支付 -->
		<div class="order_status dfzf  qwer">
			<img src="../img/account_check_order_status.png">
			<span>等待对方支付</span>
		</div>
		<div class="shengyu_time1 dfzf qwer">
			<p>剩余时间：<span class="time_time">29天8时45分25秒</span></p>
		</div>

		<!-- 等待我方支付 -->
		<div class="order_status wfzf qwer">
			<img src="../img/account_check_order_status.png">
			<span>等待我方支付</span>
		</div>
		<div class="shengyu_time wfzf qwer">
			<p>剩余时间：<span class="time_time">29天8时45分25秒</span>，您可以：</p>
			<div class="operate_btn">
				<span class="liji_pay_btn">立即支付</span>
			</div>
		</div>

		<!-- 拒绝 -->
		<div class="order_status1 jujue qwer">
			<img src="../img/cha_icon2.png">
			<span class="span_span">已拒绝</span>
			<p>拒绝时间：<span class="time">23时 45分 25秒</span></p>
		</div>
		<!--!&#45;&#45; 取消&ndash;&gt;-->
		<div class="order_status1 quxiao qwer">
			<img src="../img/cha_icon2.png">
			<span class="span_span">已取消</span>
			<p>取消时间：<span class="time">23时 45分 25秒</span></p>
		</div>

		<!-- 完成 -->
		<div class="order_status1 wancheng qwer">
			<!--<img src="../img/cha_icon2.png">-->
			<span class="span_span">已完成</span>
			<p>完成时间：<span class="time">23时 45分 25秒</span></p>
		</div>

		<div class="order_info">
			<div class="order_info_title">
				<span>订单信息</span>
				<span class="fr order_num">订单编号：000</span>
			</div>
			<div class="order_info_cont">
				<ul class="clearfix">
					<li>兑账企业：<span class="dzqy">000</span></li>
					<li>兑账订单</li>
					<li>兑账金额：<span>000</span></li>
					<li>应收：<span>000</span></li>
					<li>支付方式：<span>000</span></li>
					<li>应付：<span>000</span></li>
				</ul>
			</div>
			<div class="order_money">
				<div>兑账订单总金额：<span>000</span>元</div>
				<div>现汇金额：<span>000</span>元</div>
				<div>承兑汇票：<span>000</span>元</div>
			</div>
		</div>
	</div>
	<script src="../js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/common.js" type="text/javascript" charset="utf-8"></script>
	<script>
		//获取地址栏参数，name:参数名称
		function getUrlParms(name){
			var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
			var r = window.location.search.substr(1).match(reg);
			if(r!=null)
			return unescape(r[2]);
			return null;
		}
		var orderId = getUrlParms("orderId");
		//兑账订单详情
		$.ajax({ 
			type: "get",
			url: pubIP + "accountChecking/getAccountCheckingOrderDetail",//v1.0
			cache: false,
			dataType: "json",
			headers: {
				token: token
			},
			data:{
				orderId: orderId
			},
			success: function(json){
				console.log(json);
				if(json.code == 1){
                    var data = json.data;
					var item = json.data;
//					var item=
//					$.each(data,function(idx,item){
						if(item.status == 1){//待确认（双方）
							if(item.submitType == 1){//本公司是提交公司
								$(".dfqr").show();
							}else if(item.submitType == 2){//本公司非提交公司
								$(".wfqr").show();
							}
						}else if(item.status == 2){//（双方）
							if(item.payCompanyType == 1){//等待我方支付
								$(".wfzf").show();
							}else if(item.payCompanyType == 2){//等待对方支付
								$(".dfzf").show();
							}
						}else if(item.status == 3){//拒绝
							$(".jujue").show();
						}else if(item.status == 4){//已取消
                            $(".quxiao").show();
                        }else if(item.status == 5){//已完成
                            $(".wancheng").show();
                        }
//                        timestamp()

						$(".time").text(timestampToTime1(item.updateTime))
//					})
					//订单详情
					$(".order_num").html("订单编号："+data.accountCheckingId);//订单号
					$(".dzqy").html(data.companyName);//对方名称

				}
				
				
			},
			error:function(xhr,statues,error){
				console.log(error);
			}
		});

//		确认
        $(".ok_order").unbind();
		$(".ok_order").click(function () {
            $.ajax({
                type: "get",
                url: pubIP + "accountChecking/updateConfirmAccountCheckingOrder",//v1.0
                cache: false,
                dataType: "json",
                headers: {
                    token: token
                },
                data:{
                    orderId: orderId
                },
                success: function(json){
                    if(json.code == 1){
                        cf_alert(1,"确认成功")
                    }else{
                        cf_alert1(2,json.msg)
                    }
                },
                error:function(xhr,statues,error){
                    console.log(error);
                }
            });
        })


        //		拒绝
        $(".jujue_order").unbind();
        $(".jujue_order").click(function () {
            $.ajax({
                type: "get",
                url: pubIP + "accountChecking/updateCancelAccountCheckingOrder",//v1.0
                cache: false,
                dataType: "json",
                headers: {
                    token: token
                },
                data:{
                    orderId: orderId
                },
                success: function(json){
                    if(json.code == 1){
                        cf_alert(1,"拒绝成功")
                    }else{
                        cf_alert1(2,json.msg)
                    }
                },
                error:function(xhr,statues,error){
                    console.log(error);
                }
            });
        })
        //		取消
        $(".cancel_accountCheck_btn").unbind();
        $(".cancel_accountCheck_btn").click(function () {
            $.ajax({
                type: "get",
                url: pubIP + "accountChecking/updateCancelAccountCheckingOrder",//v1.0
                cache: false,
                dataType: "json",
                headers: {
                    token: token
                },
                data:{
                    orderId: orderId
                },
                success: function(json){
                    if(json.code == 1){
                        cf_alert(1,"取消成功")
                    }else{
                        cf_alert1(2,json.msg)
					}
                },
                error:function(xhr,statues,error){
                    console.log(error);
                }
            });
        })


        //时间戳转时间
        function timestampToTime1(timestamp) {
            if(timestamp==0 || timestamp=="" || timestamp==null){
                return "";
            }
            if(timestamp/100000000000<0){
                var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
            }else{
                var date = new Date(timestamp );//时间戳为10位需*1000，时间戳为13位的话不需乘1000
            }

            Y = date.getFullYear() + '-';
            M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
            D = date.getDate();
            h = date.getHours();
            m = date.getMinutes();
            s = date.getSeconds();
            D=D<10?'0'+D:D;
            h=h<10?'0'+h:h;
            m=m<10?'0'+m:m;
            s=s<10?'0'+s:s;
            return Y+M+D+" "+h+":"+m+":"+s;
        }
	</script>
</body>
</html>