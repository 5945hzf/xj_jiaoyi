<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="format-detection" content="telephone=no" />
	<title>新疆化学品经营服务平台</title>
	<link rel="stylesheet" type="text/css" href="../css/index.css"/>
	<link rel="stylesheet" type="text/css" href="../css/home.css"/>
	<link rel="stylesheet" type="text/css" href="../css/common.css"/>
	<link rel="stylesheet" type="text/css" href="../css/memberCenter/ConvertibilityRecord.css"/>
</head>
<style>
	body{
            background-color: #ffffff;
        }
        .container{
            height: 1200px;
            border: 1px solid #ebe9ea;
            width: 986px;
        }
        .containerTitle{
            height: 49px;line-height: 49px;padding-left: 18px;border-bottom: 1px solid #ebe9ea;font-size: 16px;
        }
        .containerTop{border-bottom: 1px solid #ebe9ea;overflow: hidden}
        .containerTopLe{width: 647px;}
        .containerTopLe1{overflow: hidden;padding-top: 41px;}
        .containerTopLeImg{margin-left: 57px;margin-right: 10px;width: 59px;height: 59px;}
        .containerTopLeImg img{width: 100%;height: 100%;}
        .containerTopRi{width: 307px;height: 95px;overflow: hidden;padding: 28px 12px 31px 19px;background-color: #fdfdfd;border-left: 1px solid #ebe9ea;}
        .jifenjilu{height: 851px;}
        .jifenjilu table{width: 100%;}
        .jifenjilu table thead{background-color: #fdfdfd;height: 44px; line-height: 44px;border-bottom:1px solid #ebe9ea;border-top:1px solid #ebe9ea; }
        .jifenjilu table thead tr td {text-align: center;}
        .jifenjilu table tbody tr{border-bottom:1px solid #ebe9ea;height: 52px;line-height: 52px;font-size: 14px;}
        .jifenjilu table tbody tr td {text-align: center; font-size: 14px;}
        .jifenSta{font-size: 12px;color: white;width: 54px; height: 18px; border: 1px solid #67b655; text-align: center; line-height: 18px; display: inline-block; margin-right: 8px;}
        .jifenNum{color:#f97646; }
        .green{background-color: #6dc756;}
        .jifenNav{font-size: 14px; }
        .jifenNav>div{width: 64px;text-align: center;margin-right: 67px;height: 51px; line-height: 51px;}
        .jifenNav>div.on{border-bottom: 4px solid #f97646;}
        
        .jifenjilu table thead tr {
        	font-size: 14px;
        }

        .jifenNum span {
			width: 25px;
			height: 25px;
			text-align: center;
			line-height: 25px;
			color: #fff;
			font-size: 12px;
			display: inline-block;
			background: #ff9877;
			border-radius: 50%;
			border: 1px solid #f8906e;
        }

        .person_img {
        	vertical-align: middle;
        	margin-right: 5px;
        }

        .duihuanjilu table {
			font-size: 14px;
			text-align: center;
        }

        .xiaohao {
        	color: #F66132;
        	font-weight: 600;
        }

        .duihuan_success {
        	color: #7CBA3F;
        }
		
		.duihuanjilu table thead tr {
			height: 44px;
			line-height: 44px;
			background: #fdfdfd;
			border-top: 1px solid #ebe9ea;
			border-bottom: 1px solid #ebe9ea;
		}

		.duihuanjilu table tbody tr {
			height: 53px;
			border-bottom: 1px solid #ebe9ea;
		}

		.duihuanjilu tbody tr td {
			vertical-align: middle;
		}		

		.duihuanjilu {
			height: 851px;
		}

		
</style>
<body>
	
	<!-- 积分兑换记录 -->
	<div class="container">
	    <div class="containerTitle">
	        企业积分
	    </div>
	    <div class="containerTop">
	        <div class="containerTopLe Lf">

	            <div class="containerTopLe1 Lf">
	                <div class="containerTopLeImg Lf">
	                    <img src="../img/record1.png" alt="">
	                </div>
	                <div class="Lf">
	                    <div style="font-size: 30px;color: #F66132;" class="totalIntegral">0</div>
	                    <div style="font-size: 14px;">总积分</div>
	                </div>
	            </div>
	            <div class="containerTopLe1 Lf">
	                <div class="containerTopLeImg Lf">
	                    <img src="../img/record2.png" alt="">
	                </div>
	                <div class="Lf">
	                    <div style="font-size: 30px;color: #7CBA3F;" class="usableIntegral">0</div>
	                    <div style="font-size: 14px;">可用积分</div>
	                </div>
	            </div>
	            <div class="containerTopLe1 Lf">
	                <div class="containerTopLeImg Lf">
	                    <img src="../img/record3.png" alt="">
	                </div>
	                <div class="Lf">
	                    <div style="font-size: 30px;color: #6EA3FF;" class="consumeIntegral">0</div>
	                    <div style="font-size: 14px;">已分配积分</div>
	                </div>
	            </div>


	        </div>

	        <div class="containerTopRi  Lf">
	            <div style="font-size: 16px;color: #282828;margin-bottom: 20px;">
	                <img style="vertical-align: middle;" src="../img/prompt.png" alt="">
	                温馨提示:
	            </div>
	            <div style="color: #838383;font-size: 12px;line-height: 22px;">XSHSIHSIH化工平台为回馈会员，特别推出的会员积分。会员可将账户内累计的积分用于兑换积分平台上推出的相关产品和增值服务。</div>
	        </div>
	    </div>
	    <div class="centera">
	    	<div class="jifenNav" id="oranger" style="overflow: hidden;">
		        <div class="Lf on" style="margin-left: 29px;">积分记录</div>
		        <div class="Lf">兑换记录</div>
		    </div>
		    <div id="tablea" class="tablea">
		    	<div class="box">
		    		<div class="jifenjilu">
				        <table>
				            <thead>
				                <tr>
				                    <td>时间</td>
				                    <td>行为</td>
				                    <td>积分数</td>
				                    <td>操作用户</td>
				                </tr>
				            </thead>
				            <tbody class="tbody">
				                <!-- <tr>
				                    <td style="width: 260px;">2018-01-02 10:02:30</td>
				                    <td style="width: 350px;"><i class="jifenSta green">完成任务</i>成功注册账户，获得积分：<i style="color: #f97646;">1</i></td>
				                    <td class="jifenNum"><span>+1</span></td>
				                    <td style="width: 200px;"><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr>
				                <tr>
				                    <td style="width: 260px;">2018-01-02 10:02:30</td>
				                    <td style="width: 350px;"><i class="jifenSta green">完成任务</i>成功注册账户，获得积分：<i style="color: #f97646;">1</i></td>
				                    <td class="jifenNum"><span>+1</span></td>
				                    <td style="width: 200px;"><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr>
				                <tr>
				                    <td style="width: 260px;">2018-01-02 10:02:30</td>
				                    <td style="width: 350px;"><i class="jifenSta green">完成任务</i>成功注册账户，获得积分：<i style="color: #f97646;">1</i></td>
				                    <td class="jifenNum"><span>+1</span></td>
				                    <td style="width: 200px;"><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr> -->
				            </tbody>
				        </table>
				    </div>
				    <!-- <div class="" style="text-align: center;height: 75px;padding-top: 17px;margin-bottom: 0;border-top: 1px solid #ebe9ea;">
				        <ul class="pagination" id="page1" style="position: static;margin-bottom: 0;"></ul>
				        <div class="pageJump">
				            <span class="allPageN">1/200</span>
				            <i style="margin-left: 12px;">共200页</i>，
				            <span>到第</span>
				            <input type="text"/>
				            <span>页</span>
				            <button type="button" class="button">GO</button>
				        </div>
				    </div> -->
		    	</div>
		    	<div class="box">
		    		<div class="duihuanjilu">
				        <table>
				            <thead>
				                <tr>
				                    <td style="width: 165px;">商品名称</td>
				                    <td style="width: 131px;">数量</td>
				                    <td style="width: 150px;">消耗积分数</td>
				                    <td style="width: 230px;">兑换时间</td>
				                    <td style="width: 150px;">状态</td>
				                    <td style="width: 160px;">兑换账号</td>
				                </tr>
				            </thead>
				            <tbody class="tbody2">
				                <!-- <tr>
				                    <td class="duihuan_name">3个月的广告位</td>
				                    <td class="xiaohao">1</td>
				                    <td class="xiaohao">-500</td>
				                    <td>2018-01-02 10:02:30</td>
				                    <td class="duihuan_success"><img src="../img/duihuan_success.png" alt=""><span>兑换成功</span></td>
				                    <td style=""><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr>
				                <tr>
				                    <td class="duihuan_name">3个月的广告位</td>
				                    <td class="xiaohao">1</td>
				                    <td class="xiaohao">-500</td>
				                    <td>2018-01-02 10:02:30</td>
				                    <td class="duihuan_success"><img src="../img/duihuan_success.png" alt=""><span>兑换成功</span></td>
				                    <td style=""><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr>
				                <tr>
				                    <td class="duihuan_name">3个月的广告位</td>
				                    <td class="xiaohao">1</td>
				                    <td class="xiaohao">-500</td>
				                    <td>2018-01-02 10:02:30</td>
				                    <td class="duihuan_success"><img src="../img/duihuan_success.png" alt=""><span>兑换成功</span></td>
				                    <td style=""><img class="person_img" src="../img/personal_pic.png" alt="">张三</td>
				                </tr> -->
				            </tbody>
				        </table>
				    </div>
		    	</div>
		    </div>

		    <div class="mianCont pageCont" style="width:980px;text-align:center;overflow: hidden;height: auto;margin: 20px auto">
		        <ul class="pagination" id="page1"></ul>
		        <div class="pageJump">
		                    <span class="allPageN">1/1</span>
		                    <span>共<span class="total">1</span>页，</span>
		            <span>到第</span>
		            <input type="text" style="text-align: center; padding-left: 0px;"/>
		            <span>页</span>
		            <button type="button" class="button">GO</button>
		        </div>
		    </div>
	    </div>    	
	</div>


	<script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/pager.js" type="text/javascript" charset="utf-8"></script>
    
	<script>
		$(function(){  
			$(".tablea").find(".box").hide(); 
		  	$(".tablea").find(".box").eq(0).show();    //为每个BOX的第一个元素显示        
			$("#oranger div").on("click",function(){ //给div标签添加事件  
			     var index=$(this).index();  //获取当前div标签的个数  
			     $(this).parent().next().find(".box").hide().eq(index).show(); //返回上一层，在下面查找css名为box隐藏，然后选中的显示  
			     $(this).addClass("on").siblings().removeClass("on"); //a标签显示，同辈元素隐藏  

			     console.log($(this).text());

			     if ($(this).text() == '兑换记录') {
			     	isFirst = true;
					personalGrowthValue(1, 15, '', '', 1, 2);
			     } else {
			     	isFirst = true;
			     	personalGrowthValue(1, 15, '', '', 1, '');
			     }

			})  
		}) 

        var isFirst = true;

		personalGrowthValue(1, 15, '', '', 1, '');
		// 
		function personalGrowthValue(num, size, time, source, type, integralType) {
			$.ajax({
				type:"get",
		        url:pubIP+"member/getUserGrowhtInfo",//v1.0
		        cache:false,
		        dataType: "json",
		        async:false,
		        headers: {
	                Accept: "application/json; charset=utf-8",
	                token: token
	            },
	            data: {
	            	pageNum: num,
	            	pageSize: size,
	            	time: time,
	            	source: source,
	            	type: type,
	            	integralType: integralType
	            },
		        success: function(data){
		        	console.log(data);
		        	
		        	if (data.code == 1) {

		        		if (data.companyInfo) {
		        			$('.consumeIntegral').text(data.companyInfo.consumeIntegral == null ? 0 : data.companyInfo.consumeIntegral);
		        			$('.totalIntegral').text(data.companyInfo.totalIntegral == null ? 0 : data.companyInfo.totalIntegral);
		        			$('.usableIntegral').text(data.companyInfo.usableIntegral == null ? 0 : data.companyInfo.usableIntegral);
		        			
		        		}

		        		if (data.data.result.length != 0) {

		        			$('#page1').show();
		        			$('.pageJump').show();

		        			var str = '';
		        			for (var i = 0; i < data.data.result.length; i++) {
		        				
		        				data.data.result[i].time = new Date(data.data.result[i].time).Format("yyyy-MM-dd hh:mm");

		        				if (integralType == '') { //积分记录
			        				str += '<tr>'
					                    +'<td style="width: 260px;">'+data.data.result[i].time+'</td>'
					                    +'<td style="width: 350px;"><i class="jifenSta green">完成任务</i>'+data.data.result[i].source+'，获得积分：<i style="color: #f97646;">'+data.data.result[i].score+'</i></td>'
					                    +'<td class="jifenNum"><span>+'+data.data.result[i].score+'</span></td>'
					                    +'<td style="width: 200px;"><img class="person_img" src="../img/personal_pic.png" alt="">'+data.data.result[i].userName+'</td>'
					                +'</tr>'
			        			} else if (integralType == 2) { //兑换记录
			        				str += '<tr>'
					                    +'<td class="duihuan_name">'+data.data.result[i].source+'</td>'
					                    +'<td class="xiaohao">1</td>'
					                    +'<td class="xiaohao">-'+data.data.result[i].score+'</td>'
					                    +'<td>'+data.data.result[i].time+'</td>'
					                    +'<td class="duihuan_success"><img src="../img/duihuan_success.png" alt=""><span>兑换成功</span></td>'
					                    +'<td style=""><img class="person_img" src="../img/personal_pic.png" alt="">'+data.data.result[i].userName+'</td>'
					                +'</tr>'
			        			}
		        				
		        			}

		        			if (integralType == '') { //积分记录

		        				$('.tbody').html(str);

		        			} else if (integralType == 2) {
								$('.tbody2').html(str);
		        			}

		        			if (isFirst) {
                            
	                            Page({
	                                num: data.data.pages,
	                                elem: $('#page1'),
	                                callback: function(n) {
	                                    personalGrowthValue(n, size, time, source);
	                                }
	                            });

	                            $('.total').text(data.data.pages);


	                            isFirst = false;
	                       }

	                        $('.allPageN').text(num+'/'+data.data.pages);
		        			

		        		} else {
		        			$('.tbody').html('');
		        			$('#page1').hide();
		        			$('.pageJump').hide();
		        		}
		        	}

		        },
		        error: function(err) {
		        	console.log(err);
		        }
		    }); 
		} 
	</script>

</body>
</html>